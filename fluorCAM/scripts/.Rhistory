geom_point(aes(y = X70minus, color = "AT5G45470 E-"), shape = 16, size = 3) +
geom_line(aes(y = X70plus, color = "AT5G45470 E+"), linetype = "solid", size = 0.7) +
geom_point(aes(y = X70plus, color = "AT5G45470 E+"), shape = 16, size = 3) +
geom_line(aes(y = Wtminus, color = "WT E-"), linetype = "solid", size = 0.7) +
geom_point(aes(y = Wtminus, color = "WT E-"), shape = 16, size = 3) +
geom_line(aes(y = Wtplus, color = "WT E+"), linetype = "solid", size = 0.7) +
geom_point(aes(y = Wtplus, color = "WT E+"), shape = 16, size = 3) +
ggtitle("Kwitnienie w czasie") +  # Tytuł wykresu
labs(x = "Dni", y = "Ilość roślin posiadających kwiat") +
scale_y_continuous(limits =c(0, 25)) +
scale_color_manual(
values = c(
"AT5G45470 E-" = "#A6CEE3",
"AT5G45470 E+" = "#1F78B4",
"WT E-" = "#B2DF8A",
"WT E+" = "#33A02C"
),
name = "",
labels = c(
"AT5G45470 E-" = "AT5G45470 E-",
"AT5G45470 E+" = "AT5G45470 E+",
"WT E-" = "WT E-",
"WT E+" = "WT E+"
)
) +  # Definicja etykiety legendy
theme(legend.position = "top", text = element_text(size = 20)) +
theme(plot.title = element_text(hjust = 0.5)) + # Środkowanie tytułu
theme(
panel.background = element_rect(fill = "white"),  # Białe tło
panel.grid.major = element_line(color = "lightgray", size = 0.5), # Szare linie siatki
panel.grid.minor = element_blank()  # Wyłącz linie siatki pomocniczej
)
ggsave(filename = file.path(path, 'figures/plots/kwitnienie70.png'), plot = kwit_plot, width = 12, height = 8)
liscie_plot <- ggplot(liscie, aes(x = DNI)) +
geom_line(aes(y = X70minus, color = "AT5G45470 E-"), linetype = "solid", size = 0.7) +
geom_point(aes(y = X70minus, color = "AT5G45470 E-"), shape = 16, size = 3) +
geom_line(aes(y = X70plus, color = "AT5G45470 E+"), linetype = "solid", size = 0.7) +
geom_point(aes(y = X70plus, color = "AT5G45470 E+"), shape = 16, size = 3) +
geom_line(aes(y = Wtminus, color = "WT E-"), linetype = "solid", size = 0.7) +
geom_point(aes(y = Wtminus, color = "WT E-"), shape = 16, size = 3) +
geom_line(aes(y = Wtplus, color = "WT E+"), linetype = "solid", size = 0.7) +
geom_point(aes(y = Wtplus, color = "WT E+"), shape = 16, size = 3) +
labs(x = "Dni", y = "Sumaryczna liczba liści", title = "Liczba liści w czasie") +
scale_y_continuous(limits =c(0, 210)) +
scale_color_manual(
values = c(
"AT5G45470 E-" = "#A6CEE3",
"AT5G45470 E+" = "#1F78B4",
"WT E-" = "#B2DF8A",
"WT E+" = "#33A02C"
),
name = "",
labels = c(
"AT5G45470 E-" = "AT5G45470 E-",
"AT5G45470 E+" = "AT5G45470 E+",
"WT E-" = "WT E-",
"WT E+" = "WT E+"
)
) +
theme(legend.position = "top") +
theme(plot.title = element_text(hjust = 0.5), text = element_text(size = 20)) + # Środkowanie tytułu
theme(
panel.background = element_rect(fill = "white"),  # Białe tło
panel.grid.major = element_line(color = "lightgray", size = 0.5), # Szare linie siatki
panel.grid.minor = element_blank()  # Wyłącz linie siatki pomocniczej
)
ggsave(filename = file.path(path, 'figures/plots/liscie70.png'), plot = liscie_plot, width = 12, height = 8)
kwit_path_aov <- file.path(path, "pot_cultures/data/kwitnienie70_anova.ods")
liscie_path_aov <- file.path(path, "pot_cultures/data/liscie70_anova.ods")
kwit_aov <- read_ods(kwit_path_aov)
liscie_aov <- read_ods(liscie_path_aov)
anova <- aov(data = kwit_aov, formula = wynik ~ DNI * rodzaj)
summary(anova)
TukeyHSD(anova)
anova2 <- aov(data = liscie_aov, formula = wynik ~ DNI * rodzaj)
summary(anova2)
TukeyHSD(anova2)
require(dotenv)
require(ggplot2)
require(readxl)
require(dplyr)
require(dotenv)
path <- Sys.getenv("MY_PATH")
path
plant <- c(rep("WT E-", 3), rep("WT E+", 3), rep("AT5G45470 E-", 3), rep("AT5G45470 E+", 3))
weight <- c(19.4, 19.8, 18.4, 17.4, 19.4, 18.2, 18.8, 16.2, 15.8, 19.2, 16.4, 18.1)
df <- data.frame(plant, weight)
df
means <- df %>%
group_by(plant) %>%
dplyr::summarise(weight = mean(weight))
means$error.bars <- c(0.72, 1.42, 1.63, 1.42)
means
seed_plot <- ggplot(df, aes(x = plant, y = weight, fill = plant)) +
geom_boxplot(outlier.size = 0.5, outlier.colour = "red") +
ggtitle("Wpływ inokulacji i mutacji na wage nasion") +
geom_point(alpha=0.8) +
labs(x = "", y = "Waga 50 nasion [mg]") +
scale_fill_manual(values = c("#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C"),
name = "") +
coord_cartesian(ylim = c(0, max(means$weight) + 1)) +
theme(legend.position = "top", text = element_text(size = 20)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(
panel.background = element_rect(fill = "white"),  # Białe tło
panel.grid.major = element_line(color = "lightgray", size = 0.5), # Szare linie siatki
panel.grid.minor = element_blank(),  # Wyłącz linie siatki pomocniczej
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
seed_plot
ggsave(filename = file.path(path, 'figures/plots/nasiona.png'), plot = liscie_plot, width = 12, height = 8)
t.test.70 <- t.test(df$weight[1:3],df$weight[4:6], var.equal = TRUE)
t.test.70
anova_seeds <- aov(data = df, formula = weight ~ plant)
summary(anova_seeds)
t.test.80 <- t.test(df$weight[7:9],df$weight[10:12], var.equal = TRUE)
t.test.80
ggsave(filename = file.path(path, 'figures/plots/nasiona.png'), plot = liscie_plot, width = 12, height = 8)
require(ggplot2)
require(readxl)
require(dplyr)
require(dotenv)
path <- Sys.getenv("MY_PATH")
path
plant <- c(rep("WT E-", 3), rep("WT E+", 3), rep("AT5G45470 E-", 3), rep("AT5G45470 E+", 3))
weight <- c(19.4, 19.8, 18.4, 17.4, 19.4, 18.2, 18.8, 16.2, 15.8, 19.2, 16.4, 18.1)
df <- data.frame(plant, weight)
df
means <- df %>%
group_by(plant) %>%
dplyr::summarise(weight = mean(weight))
means$error.bars <- c(0.72, 1.42, 1.63, 1.42)
means
seed_plot <- ggplot(df, aes(x = plant, y = weight, fill = plant)) +
geom_boxplot(outlier.size = 0.5, outlier.colour = "red") +
ggtitle("Wpływ inokulacji i mutacji na wage nasion") +
geom_point(alpha=0.8) +
labs(x = "", y = "Waga 50 nasion [mg]") +
scale_fill_manual(values = c("#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C"),
name = "") +
coord_cartesian(ylim = c(0, max(means$weight) + 1)) +
theme(legend.position = "top", text = element_text(size = 20)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(
panel.background = element_rect(fill = "white"),  # Białe tło
panel.grid.major = element_line(color = "lightgray", size = 0.5), # Szare linie siatki
panel.grid.minor = element_blank(),  # Wyłącz linie siatki pomocniczej
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
ggsave(filename = file.path(path, 'figures/plots/nasiona.png'), plot = liscie_plot, width = 12, height = 8)
t.test.70 <- t.test(df$weight[1:3],df$weight[4:6], var.equal = TRUE)
t.test.70
anova_seeds <- aov(data = df, formula = weight ~ plant)
summary(anova_seeds)
t.test.80 <- t.test(df$weight[7:9],df$weight[10:12], var.equal = TRUE)
t.test.80
ggsave(filename = file.path(path, 'figures/plots/nasiona.png'), plot = seed_plot, width = 12, height = 8)
ggsave(filename = file.path(path, 'figures/plots/nasiona.png'), plot = seed_plot, width = 12, height = 8)
library(tidyverse)
library(broom)
library(dplyr)
library(reshape)
library(multcompView)
library(dotenv)
load_dot_env(file = ".env")
path <- Sys.getenv("MY_PATH")
path
file_path <- file.path(path, "fluorCAM/measurements/measurement1/concatenated_file.tsv")
data_all <- read.csv(file_path, sep = '\t')
library(tidyverse)
library(broom)
library(dplyr)
library(reshape)
library(multcompView)
library(dotenv)
load_dot_env(file = ".env")
path <- Sys.getenv("MY_PATH")
path
file_path <- file.path(path, "fluorCAM/measurements/measurement1/concatenated_file.tsv")
data_all <- read.csv(file_path, sep = '\t')
colnames(data_all)
# Kolumna z grupami
data_all$plant <- as.factor(data_all$plant)
library(tidyverse)
library(broom)
library(dplyr)
library(reshape)
library(multcompView)
library(dotenv)
load_dot_env(file = ".env")
path <- Sys.getenv("MY_PATH")
path
file_path <- file.path(path, "fluorCAM/measurements/measurement1/concatenated_file.tsv")
data_all <- read.csv(file_path, sep = '\t')
colnames(data_all)
# Kolumna z grupami
data_all$plant <- as.factor(data_all$plant)
data_all$inoculation <- as.factor(data_all$inoculation)
library(tidyverse)
library(broom)
library(dplyr)
library(reshape)
library(multcompView)
library(dotenv)
load_dot_env(file = ".env")
path <- Sys.getenv("MY_PATH")
file_path <- file.path(path, "fluorCAM/measurements/measurement1/concatenated_file.tsv")
data_all <- read.csv(file_path, sep = '\t')
colnames(data_all)
# Kolumna z grupami
data_all$plant <- as.factor(data_all$plant)
data_all$inoculation <- as.factor(data_all$inoculation)
plant <- data_all$plant
inoculation <- data_all$inoculation
significant_columns <- list()
# Pętla do analizy wariancji dla każdej kolumny
for (column_name in colnames(data_all)) {
if (column_name != "plant" & column_name != "inoculation") {  # Sprawdzamy kolumny inne niż 'plant' i 'inoculation'
# Tworzymy formułę ANOVA
formula <- as.formula(paste(column_name, "~ plant * inoculation"))
# Przeprowadzamy ANOVA
anova_result <- aov(formula, data = data_all)
df_anova <- data.frame(summary(anova_result)[[1]])
p_value_anova <- df_anova$Pr..F.[1]
# Przeprowadzamy test Tukeya
tukey_result <- TukeyHSD(anova_result)
# Jeśli p-value jest mniejsze niż 0.05, dodaj nazwę kolumny do significant_columns
if (p_value_anova < 0.05) {
significant_columns[[length(significant_columns) + 1]] <- column_name
}
}
}
significant_cols <- trimws(significant_columns)
significant_cols
# Create a new column 'group'
data_all$group <- with(data_all, interaction(inoculation, plant, drop = TRUE))
# Convert 'group' to a numeric representation
data_all$group <- as.numeric(data_all$group) - 1
# Print the resulting data_all table
print(data_all)
formula <- as.formula(paste(Rfd_Lss, "~ plant * inoculation"))
formula <- as.formula(paste('Rfd_Lss', "~ plant * inoculation"))
formula <- as.formula(paste('Rfd_Lss', "~ plant * inoculation"))
# Przeprowadzamy ANOVA
anova2d <- aov(formula, data = data_all)
TukeyHSD(anova2d)
#2d anova for NPQ_Lss
formula <- as.formula(paste('NPQ_Lss', "~ plant * inoculation"))
anova2d <- aov(formula, data = data_all)
TukeyHSD(anova2d)
library(tidyverse)
library(broom)
library(dplyr)
library(reshape)
library(multcompView)
library(dotenv)
load_dot_env(file = ".env")
path <- Sys.getenv("MY_PATH")
file_path <- file.path(path, "fluorCAM/measurements/measurement2/concatenated_file.tsv")
data_all <- read.csv(file_path, sep = '\t')
colnames(data_all)
# Kolumna z grupami
data_all$plant <- as.factor(data_all$plant)
data_all$inoculation <- as.factor(data_all$inoculation)
plant <- data_all$plant
inoculation <- data_all$inoculation
significant_columns <- list()
# Pętla do analizy wariancji dla każdej kolumny
for (column_name in colnames(data_all)) {
if (column_name != "plant" & column_name != "inoculation") {  # Sprawdzamy kolumny inne niż 'plant' i 'inoculation'
# Tworzymy formułę ANOVA
formula <- as.formula(paste(column_name, "~ plant * inoculation"))
# Przeprowadzamy ANOVA
anova_result <- aov(formula, data = data_all)
df_anova <- data.frame(summary(anova_result)[[1]])
p_value_anova <- df_anova$Pr..F.[1]
# Przeprowadzamy test Tukeya
tukey_result <- TukeyHSD(anova_result)
# Jeśli p-value jest mniejsze niż 0.05, dodaj nazwę kolumny do significant_columns
if (p_value_anova < 0.05) {
significant_columns[[length(significant_columns) + 1]] <- column_name
}
}
}
significant_cols <- trimws(significant_columns)
significant_cols
#2d anova for Rfd_Lss
formula <- as.formula(paste('Rfd_Lss', "~ plant * inoculation"))
anova2d <- aov(formula, data = data_all)
TukeyHSD(anova2d)
#2d anova for NPQ_Lss
formula <- as.formula(paste('NPQ_Lss', "~ plant * inoculation"))
anova2d <- aov(formula, data = data_all)
TukeyHSD(anova2d)
# Create a new column 'group'
data_all$group <- with(data_all, interaction(inoculation, plant, drop = TRUE))
# Convert 'group' to a numeric representation
data_all$group <- as.numeric(data_all$group) - 1
# Print the resulting data_all table
print(data_all)
data_all$group <- as.factor(data_all$group)
# anova
anova <- aov(Rfd_Lss ~ group, data = data_all)
print(anova)
# Tukey's test
tukey <- TukeyHSD(anova)
print(tukey)
# compact letter display
cld <- multcompLetters4(anova, tukey)
# table with factors and 3rd quantile
dt <- group_by(data_all, group) %>%
summarise(w=mean(Rfd_Lss), sd = sd(Rfd_Lss)) %>%
arrange(desc(w))
# extracting the compact letter display and adding to the Tk table
cld <- as.data.frame.list(cld$group)
dt$cld <- cld$Letters
rfd_pomiar2 <- ggplot(dt, aes(group, w, fill = factor(group))) +
geom_bar(stat = "identity", show.legend = TRUE) +
geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
ggtitle("Rfd w zależności od grupy roślin, pomiar 2") +
labs(x = "", y = "Rfd") +
geom_text(aes(label = cld, y = w + sd), vjust = -0.5) +
scale_fill_manual(
values = c("#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C"),
breaks = c(0, 1, 2, 3),
labels = c("AT5G45470 E-", "AT5G45470 E+", "WT E-", "WT"),
name = ""
) +
theme(legend.position = "top", text = element_text(size = 20)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "lightgray", size = 0.5),
panel.grid.minor = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
data_all$group <- as.factor(data_all$group)
# anova
anova <- aov(NPQ_Lss ~ group, data = data_all)
print(anova)
# Tukey's test
tukey <- TukeyHSD(anova)
print(tukey)
# compact letter display
cld <- multcompLetters4(anova, tukey)
# table with factors and 3rd quantile
dt <- group_by(data_all, group) %>%
summarise(w=mean(NPQ_Lss), sd = sd(NPQ_Lss)) %>%
arrange(desc(w))
# extracting the compact letter display and adding to the Tk table
cld <- as.data.frame.list(cld$group)
dt$cld <- cld$Letters
npq_pomiar2 <- ggplot(dt, aes(group, w, fill = factor(group))) +
geom_bar(stat = "identity", show.legend = TRUE) +
geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
ggtitle("NPQ w zależności od grupy roślin, pomiar 2") +
labs(x = "", y = "NPQ") +
geom_text(aes(label = cld, y = w + sd), vjust = -0.5) +
scale_fill_manual(
values = c("#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C"),
breaks = c(0, 1, 2, 3),
labels = c("AT5G45470 E-", "AT5G45470 E+", "WT E-", "WT"),
name = ""
) +
theme(legend.position = "top", text = element_text(size = 20)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "lightgray", size = 0.5),
panel.grid.minor = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
library(tidyverse)
library(broom)
library(dplyr)
library(reshape)
library(multcompView)
library(dotenv)
load_dot_env(file = "master-thesis1/.env")
library(tidyverse)
library(broom)
library(dplyr)
library(reshape)
library(multcompView)
library(dotenv)
load_dot_env(file = ".env")
path <- Sys.getenv("MY_PATH")
file_path <- file.path(path, "fluorCAM/measurements/measurement3/concatenated_file.tsv")
data_all <- read.csv(file_path, sep = '\t')
colnames(data_all)
# Kolumna z grupami
data_all$plant <- as.factor(data_all$plant)
data_all$inoculation <- as.factor(data_all$inoculation)
plant <- data_all$plant
inoculation <- data_all$inoculation
significant_columns <- list()
# Pętla do analizy wariancji dla każdej kolumny
for (column_name in colnames(data_all)) {
if (column_name != "plant" & column_name != "inoculation") {  # Sprawdzamy kolumny inne niż 'plant' i 'inoculation'
# Tworzymy formułę ANOVA
formula <- as.formula(paste(column_name, "~ plant * inoculation"))
# Przeprowadzamy ANOVA
anova_result <- aov(formula, data = data_all)
df_anova <- data.frame(summary(anova_result)[[1]])
p_value_anova <- df_anova$Pr..F.[1]
# Przeprowadzamy test Tukeya
tukey_result <- TukeyHSD(anova_result)
# Jeśli p-value jest mniejsze niż 0.05, dodaj nazwę kolumny do significant_columns
if (p_value_anova < 0.05) {
significant_columns[[length(significant_columns) + 1]] <- column_name
}
}
}
significant_cols <- trimws(significant_columns)
significant_cols
#2d anova for Rfd_Lss
formula <- as.formula(paste('Rfd_Lss', "~ plant * inoculation"))
anova2d <- aov(formula, data = data_all)
TukeyHSD(anova2d)
#2d anova for NPQ_Lss
formula <- as.formula(paste('NPQ_Lss', "~ plant * inoculation"))
anova2d <- aov(formula, data = data_all)
TukeyHSD(anova2d)
# Create a new column 'group'
data_all$group <- with(data_all, interaction(inoculation, plant, drop = TRUE))
# Convert 'group' to a numeric representation
data_all$group <- as.numeric(data_all$group) - 1
# Print the resulting data_all table
print(data_all)
data_all$group <- as.factor(data_all$group)
# anova
anova <- aov(Rfd_Lss ~ group, data = data_all)
print(anova)
# Tukey's test
tukey <- TukeyHSD(anova)
print(tukey)
# compact letter display
cld <- multcompLetters4(anova, tukey)
# table with factors and 3rd quantile
dt <- group_by(data_all, group) %>%
summarise(w=mean(Rfd_Lss), sd = sd(Rfd_Lss)) %>%
arrange(desc(w))
# extracting the compact letter display and adding to the Tk table
cld <- as.data.frame.list(cld$group)
dt$cld <- cld$Letters
rfd_pomiar3 <- ggplot(dt, aes(group, w, fill = factor(group))) +
geom_bar(stat = "identity", show.legend = TRUE) +
geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
ggtitle("Rfd w zależności od grupy roślin, pomiar 3") +
labs(x = "", y = "Rfd") +
geom_text(aes(label = cld, y = w + sd), vjust = -0.5) +
scale_fill_manual(
values = c("#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C"),
breaks = c(0, 1, 2, 3),
labels = c("AT5G45470 E-", "AT5G45470 E+", "WT E-", "WT"),
name = ""
) +
theme(legend.position = "top", text = element_text(size = 20)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "lightgray", size = 0.5),
panel.grid.minor = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
data_all$group <- as.factor(data_all$group)
# anova
anova <- aov(NPQ_Lss ~ group, data = data_all)
print(anova)
# Tukey's test
tukey <- TukeyHSD(anova)
print(tukey)
# compact letter display
cld <- multcompLetters4(anova, tukey)
# table with factors and 3rd quantile
dt <- group_by(data_all, group) %>%
summarise(w=mean(NPQ_Lss), sd = sd(NPQ_Lss)) %>%
arrange(desc(w))
# extracting the compact letter display and adding to the Tk table
cld <- as.data.frame.list(cld$group)
dt$cld <- cld$Letters
npq_pomiar3 <- ggplot(dt, aes(group, w, fill = factor(group))) +
geom_bar(stat = "identity", show.legend = TRUE) +
geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
ggtitle("NPQ w zależności od grupy roślin, pomiar 3") +
labs(x = "", y = "NPQ") +
geom_text(aes(label = cld, y = w + sd), vjust = -0.5) +
scale_fill_manual(
values = c("#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C"),
breaks = c(0, 1, 2, 3),
labels = c("AT5G45470 E-", "AT5G45470 E+", "WT E-", "WT"),
name = ""
) +
theme(legend.position = "top", text = element_text(size = 20)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "lightgray", size = 0.5),
panel.grid.minor = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
ggsave(filename = file.path(path, '/figures/plots/rfd_lss_pomiar3.png'), plot = rfd_pomiar1, width = 12, height = 8)
ggsave(filename = file.path(path, '/figures/plots/rfd_lss_pomiar3.png'), plot = rfd_pomiar3, width = 12, height = 8)
ggsave(filename = file.path(path, 'figures/plots/npq_lss_pomiar3.png'), plot = npq_pomiar3, width = 12, height = 8)
ggsave(filename = file.path(path, '/figures/plots/rfd_lss_pomiar2.png'), plot = rfd_pomiar2, width = 12, height = 8)
ggsave(filename = file.path(path, 'figures/plots/npq_lss_pomiar2.png'), plot = npq_pomiar2, width = 12, height = 8)
